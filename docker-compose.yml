version: '3.8'

services:
  torrent-bot:
    build:
      context: .
      dockerfile: Dockerfile
    image: torrent-agent:latest
    container_name: torrent-bot
    restart: unless-stopped
    
    # Environment variables (override with actual values in TrueNAS Scale App config)
    environment:
      - TG_BOT_TOKEN=${TG_BOT_TOKEN}
      - ALLOWED_CHAT_IDS=${ALLOWED_CHAT_IDS:-}
      - RUTRACKER_USERNAME=${RUTRACKER_USERNAME}
      - RUTRACKER_PASSWORD=${RUTRACKER_PASSWORD}
      - QBITTORRENT_URL=${QBITTORRENT_URL}
      - QBITTORRENT_USERNAME=${QBITTORRENT_USERNAME}
      - QBITTORRENT_PASSWORD=${QBITTORRENT_PASSWORD}
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
    
    # Optional: Mount logs directory for persistence
    volumes:
      - ./logs:/app/logs
    
    # Network mode - use host network to access qBittorrent on same machine
    # Alternatively, use bridge network if qBittorrent is accessible by hostname
    network_mode: host
    # Or use bridge network:
    # networks:
    #   - torrent-network

# networks:
#   torrent-network:
#     driver: bridge

