<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Torrent Manager</title>
    <link rel="stylesheet" href="style.css?v={{ version }}">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üì• Torrent Manager {{ version }}</h1>
            <div class="refresh-indicator" id="refreshIndicator">
                <span class="refresh-dot" id="connectionDot"></span>
                <span id="connectionStatus">Connecting...</span>
            </div>
        </header>
        
        <div class="stats-bar" id="statsBar">
            <div class="stat-item">
                <span class="stat-label">Total:</span>
                <span class="stat-value" id="totalTorrents">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Downloading:</span>
                <span class="stat-value downloading" id="downloadingCount">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Seeding:</span>
                <span class="stat-value seeding" id="seedingCount">0</span>
            </div>
        </div>
        
        <div class="torrents-container" id="torrentsContainer">
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Loading torrents...</p>
            </div>
            <div class="error" id="error" style="display: none;">
                <p>‚ùå Failed to connect</p>
                <button class="retry-btn" onclick="connectWebSocket()">Retry</button>
            </div>
            <div class="torrents-list" id="torrentsList"></div>
        </div>
    </div>
    
    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu" style="display: none;">
        <div class="context-menu-item" data-action="pause">
            <span class="context-menu-icon">‚è∏Ô∏è</span>
            <span>Pause</span>
        </div>
        <div class="context-menu-item" data-action="resume">
            <span class="context-menu-icon">‚ñ∂Ô∏è</span>
            <span>Resume</span>
        </div>
        <div class="context-menu-item" data-action="files">
            <span class="context-menu-icon">üìÅ</span>
            <span>View Files</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item danger" data-action="delete">
            <span class="context-menu-icon">üóëÔ∏è</span>
            <span>Delete</span>
        </div>
    </div>
    
    <!-- File List Modal -->
    <div class="modal-overlay" id="fileModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="fileModalTitle">Torrent Files</h2>
                <button class="modal-close" onclick="closeFileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="file-list" id="fileList">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading files...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal" style="display: none;">
        <div class="modal-content small">
            <div class="modal-header">
                <h2>Delete Torrent</h2>
                <button class="modal-close" onclick="closeDeleteModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this torrent?</p>
                <label class="checkbox-label">
                    <input type="checkbox" id="deleteFiles">
                    <span>Also delete downloaded files</span>
                </label>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn btn-danger" onclick="confirmDelete()">Delete</button>
            </div>
        </div>
    </div>
    
    <script src="app.js?v={{ version }}"></script>
</body>
</html>

